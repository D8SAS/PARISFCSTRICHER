<!doctype html>
<html lang="fr">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>D√©fi Penalty Paris FC</title>
  <script src="/_sdk/element_sdk.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700;900&amp;display=swap" rel="stylesheet">
  <style>
    body {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: 'Poppins', Arial, sans-serif;
      overflow-x: hidden;
    }
    
    html, body {
      height: 100%;
    }

    * {
      box-sizing: border-box;
    }

    .game-wrapper {
      width: 100%;
      min-height: 100%;
      position: relative;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 20px;
    }

    .header {
      text-align: center;
      margin-bottom: 20px;
      z-index: 10;
    }

    .logos-container {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 30px;
      margin-bottom: 20px;
      flex-wrap: wrap;
    }

    .logo-img {
      height: 80px;
      width: auto;
      object-fit: contain;
      filter: drop-shadow(0 4px 8px rgba(0,0,0,0.2));
    }

    .logo-img.paris-fc {
      background: transparent;
      filter: drop-shadow(0 4px 8px rgba(0,0,0,0.2));
    }

    .game-title {
      font-size: 48px;
      margin: 0 0 10px 0;
      text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
    }

    .instruction {
      font-size: 18px;
      margin: 5px 0;
    }

    .stats-container {
      display: flex;
      gap: 30px;
      justify-content: center;
      align-items: center;
      margin: 15px 0;
      flex-wrap: wrap;
    }

    .stat-box {
      font-size: 24px;
      font-weight: bold;
      padding: 10px 20px;
      border-radius: 8px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.2);
    }

    .field-container {
      position: relative;
      width: 100%;
      max-width: 600px;
      aspect-ratio: 1;
      margin: 20px auto;
    }

    .goal-area {
      position: relative;
      width: 100%;
      height: 100%;
      border-radius: 12px;
      overflow: visible;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .goal-background {
      position: relative;
      width: 100%;
      height: 100%;
      display: flex;
      align-items: center;
      justify-content: center;
      background: linear-gradient(180deg, 
        #2d5016 0%, 
        #3a6b1e 25%, 
        #2d5016 50%, 
        #3a6b1e 75%, 
        #2d5016 100%);
      background-size: 100% 40px;
      border: 8px solid #1a3a0f;
      box-shadow: inset 0 0 30px rgba(0,0,0,0.3);
    }

    .goal-background::before {
      content: '';
      position: absolute;
      width: 70%;
      height: 75%;
      left: 15%;
      top: 12.5%;
      background-image: 
        repeating-linear-gradient(0deg, 
          transparent, 
          transparent 28px, 
          rgba(255, 255, 255, 0.4) 28px, 
          rgba(255, 255, 255, 0.4) 30px
        ),
        repeating-linear-gradient(90deg, 
          transparent, 
          transparent 28px, 
          rgba(255, 255, 255, 0.4) 28px, 
          rgba(255, 255, 255, 0.4) 30px
        ),
        repeating-linear-gradient(45deg, 
          transparent, 
          transparent 39px, 
          rgba(255, 255, 255, 0.25) 39px, 
          rgba(255, 255, 255, 0.25) 41px
        ),
        repeating-linear-gradient(-45deg, 
          transparent, 
          transparent 39px, 
          rgba(255, 255, 255, 0.25) 39px, 
          rgba(255, 255, 255, 0.25) 41px
        );
      border: 4px solid rgba(255, 255, 255, 0.6);
      border-radius: 6px;
      box-shadow: 
        inset 0 0 20px rgba(0, 0, 0, 0.3),
        0 4px 15px rgba(0, 0, 0, 0.4);
      z-index: 1;
      pointer-events: none;
    }

    .goal-post-left, .goal-post-right {
      position: absolute;
      width: 12px;
      height: 78%;
      background: linear-gradient(90deg, #e0e0e0, #ffffff, #e0e0e0);
      top: 11%;
      z-index: 2;
      box-shadow: 
        0 4px 15px rgba(0, 0, 0, 0.5),
        inset 2px 0 4px rgba(255, 255, 255, 0.5),
        inset -2px 0 4px rgba(0, 0, 0, 0.3);
      border-radius: 3px;
    }

    .goal-post-left {
      left: 14%;
    }

    .goal-post-right {
      right: 14%;
    }

    .goal-post-top {
      position: absolute;
      width: 72%;
      height: 12px;
      background: linear-gradient(180deg, #e0e0e0, #ffffff, #e0e0e0);
      left: 14%;
      top: 11%;
      z-index: 2;
      box-shadow: 
        0 4px 15px rgba(0, 0, 0, 0.5),
        inset 0 2px 4px rgba(255, 255, 255, 0.5),
        inset 0 -2px 4px rgba(0, 0, 0, 0.3);
      border-radius: 3px;
    }

    .goal-area {
      background-color: transparent;
    }

    .field-container {
      background-color: transparent;
    }

    .goal-net {
      position: absolute;
      width: 65%;
      height: 70%;
      left: 17.5%;
      top: 15%;
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      grid-template-rows: repeat(2, 1fr);
      gap: 8px;
      padding: 3%;
      z-index: 5;
    }

    .goal-section {
      border: 3px solid rgba(255,255,255,0.4);
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.2s;
      background: rgba(0,0,0,0.1);
      position: relative;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 48px;
    }

    .goal-section:hover:not(.disabled) {
      background: rgba(255,255,255,0.2);
      transform: scale(1.05);
      border-color: rgba(255,255,255,0.8);
    }

    .goal-section.disabled {
      cursor: not-allowed;
      opacity: 0.5;
    }

    .goalkeeper {
      position: absolute;
      width: 70px;
      height: 70px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 42px;
      transition: all 0.4s ease;
      z-index: 5;
      left: 50%;
      top: 50%;
      transform: translate(-50%, -50%);
    }

    .ball {
      position: absolute;
      width: 50px;
      height: 50px;
      border-radius: 50%;
      font-size: 40px;
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 10;
      left: 50%;
      bottom: 5%;
      transform: translateX(-50%);
      transition: all 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94);
    }

    .ball.shooting {
      transition: all 0.7s cubic-bezier(0.33, 0, 0.2, 1);
    }

    .result-message {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      font-size: 56px;
      font-weight: bold;
      text-shadow: 3px 3px 6px rgba(0,0,0,0.5);
      opacity: 0;
      z-index: 20;
      pointer-events: none;
      transition: opacity 0.3s;
    }

    .result-message.show {
      opacity: 1;
    }

    .confetti {
      position: absolute;
      width: 10px;
      height: 10px;
      background: #f0f;
      opacity: 0;
      z-index: 25;
      pointer-events: none;
    }

    .confetti.active {
      animation: confettiFall 2s ease-out forwards;
    }

    @keyframes confettiFall {
      0% {
        opacity: 1;
        transform: translateY(0) rotate(0deg);
      }
      100% {
        opacity: 0;
        transform: translateY(400px) rotate(720deg);
      }
    }

    .already-played-screen {
      display: none;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      text-align: center;
      padding: 40px;
      max-width: 600px;
      margin: 50px auto;
    }

    .already-played-screen.show {
      display: flex;
    }

    .already-played-container {
      padding: 40px;
      border-radius: 16px;
      box-shadow: 0 8px 32px rgba(0,0,0,0.3);
    }

    .already-played-title {
      font-size: 42px;
      margin: 0 0 20px 0;
      font-weight: bold;
    }

    .already-played-message {
      font-size: 20px;
      line-height: 1.6;
      margin: 15px 0;
    }

    .countdown-text {
      font-size: 24px;
      font-weight: bold;
      margin: 20px 0;
      padding: 20px;
      border-radius: 12px;
    }

    .game-over-screen {
      display: none;
      text-align: center;
      padding: 30px;
      border-radius: 16px;
      box-shadow: 0 8px 32px rgba(0,0,0,0.3);
      max-width: 500px;
      margin: 20px auto;
    }

    .game-over-screen.show {
      display: block;
    }

    .game-over-title {
      font-size: 42px;
      margin: 0 0 15px 0;
    }

    .game-over-title.victory {
      background: linear-gradient(45deg, #FFD700, #FFA500, #FFD700, #FFED4E);
      background-size: 200% auto;
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      animation: goldShine 2s linear infinite;
      filter: drop-shadow(0 0 10px rgba(255, 215, 0, 0.8));
    }

    @keyframes goldShine {
      0% {
        background-position: 0% center;
      }
      100% {
        background-position: 200% center;
      }
    }

    .game-over-message {
      font-size: 20px;
      margin: 15px 0;
    }

    .email-form-container {
      margin-top: 30px;
      padding: 25px;
      border-radius: 12px;
      box-shadow: 0 4px 16px rgba(0,0,0,0.2);
    }

    .form-title {
      font-size: 28px;
      margin: 0 0 10px 0;
    }

    .form-description {
      font-size: 16px;
      margin: 0 0 20px 0;
    }

    .submit-button {
      padding: 14px 28px;
      font-size: 18px;
      font-weight: bold;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.2s;
      box-shadow: 0 4px 12px rgba(0,0,0,0.2);
    }

    .submit-button:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 16px rgba(0,0,0,0.3);
    }

    .submit-button:disabled {
      opacity: 0.6;
      cursor: not-allowed;
      transform: none;
    }

    .rules-screen {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      text-align: center;
      padding: 20px;
      max-width: 700px;
      margin: 0 auto;
      width: 100%;
    }

    .rules-screen.hidden {
      display: none;
    }

    .rules-container {
      padding: 20px;
      border-radius: 16px;
      box-shadow: 0 8px 32px rgba(0,0,0,0.3);
      margin-top: 20px;
      width: 100%;
      max-width: 100%;
    }

    .rules-title {
      font-size: 28px;
      margin: 0 0 20px 0;
      font-weight: bold;
    }

    .rules-content {
      text-align: left;
      margin: 20px 0;
      line-height: 1.6;
    }

    .rules-section {
      margin: 15px 0;
      font-size: 16px;
    }

    .rules-section strong {
      font-weight: bold;
      display: block;
      margin-bottom: 8px;
      font-size: 18px;
    }

    .rules-highlight {
      font-weight: bold;
      font-size: 15px;
      padding: 12px;
      border-radius: 8px;
      margin: 20px 0;
      border-left: 4px solid;
      line-height: 1.5;
    }

    @media (min-width: 768px) {
      .rules-screen {
        padding: 30px;
      }

      .rules-container {
        padding: 30px;
      }

      .rules-title {
        font-size: 36px;
      }

      .rules-content {
        line-height: 1.8;
      }

      .rules-section {
        font-size: 18px;
      }

      .rules-section strong {
        font-size: 20px;
      }

      .rules-highlight {
        font-size: 17px;
        padding: 15px;
      }
    }

    .accept-button {
      font-size: 20px;
      font-weight: bold;
      padding: 18px 40px;
      border: none;
      border-radius: 12px;
      cursor: pointer;
      transition: all 0.2s;
      box-shadow: 0 6px 20px rgba(0,0,0,0.3);
      margin-top: 20px;
    }

    .accept-button:hover {
      transform: translateY(-3px);
      box-shadow: 0 8px 24px rgba(0,0,0,0.4);
    }

    .accept-button:active {
      transform: translateY(0);
    }

    .game-content {
      display: none;
    }

    .game-content.visible {
      display: block;
    }
  </style>
  <style>@view-transition { navigation: auto; }</style>
  <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
  <script src="https://cdn.tailwindcss.com" type="text/javascript"></script>
 </head>
 <body>
  <div class="game-wrapper"><!-- Rules Screen -->
   <div class="rules-screen" id="rulesScreen">
    <div class="logos-container"><img src="https://i0.wp.com/d8.fr/wp-content/uploads/2025/10/cropped-Logo-CV.png?w=500&amp;ssl=1" alt="Logo D8" class="logo-img" onerror="this.style.display='none';"> <img src="https://boutique.parisfc.fr/cdn/shop/files/logo-pfc-white-110_1920x1920.png?v=1753194124" alt="Logo Paris FC" class="logo-img paris-fc" onerror="this.style.display='none';">
    </div>
    <div class="rules-container" id="rulesContainer">
     <h1 class="rules-title" id="rulesTitle">üìã R√®glement du Jeu üìã</h1>
     <div class="rules-content" id="rulesContent">
      <div class="rules-section"><strong>üéÆ Comment jouer :</strong> Cliquez sur l'un des 4 coins de la cage pour tirer votre penalty. Le gardien tentera d'arr√™ter votre tir. Vous avez 5 tirs pour marquer au moins 3 buts et gagner !
      </div>
      <div class="rules-section"><strong>üèÜ En cas de victoire :</strong> Si vous gagnez, vous devrez saisir votre adresse email pour participer au tirage au sort et avoir la chance de gagner des billets pour le Paris FC !
      </div>
      <div class="rules-highlight" id="rulesHighlight">
       ‚ö†Ô∏è <strong>Conditions importantes :</strong><br>
        ‚Ä¢ Une seule participation par jour et par utilisateur<br>
        ‚Ä¢ La participation au jeu implique l'acceptation totale et inconditionnelle du pr√©sent r√®glement
      </div>
     </div><button class="accept-button" id="acceptButton"> ‚úÖ J'accepte le r√®glement et je commence √† jouer </button>
    </div>
   </div><!-- Game Content -->
   <div class="game-content" id="gameContent">
    <header class="header">
     <div class="logos-container"><img src="https://i0.wp.com/d8.fr/wp-content/uploads/2025/10/cropped-Logo-CV.png?w=500&amp;ssl=1" alt="Logo D8" class="logo-img" onerror="this.style.display='none';"> <img src="https://boutique.parisfc.fr/cdn/shop/files/logo-pfc-white-110_1920x1920.png?v=1753194124" alt="Logo Paris FC" class="logo-img paris-fc" onerror="this.style.display='none';">
     </div>
     <h1 class="game-title" id="gameTitle">‚öΩ D√©fi Penalty Paris FC ‚öΩ</h1>
     <p class="instruction" id="instructionText">Cliquez sur l'un des 4 coins pour tirer le penalty!</p>
     <p class="instruction" id="goalTarget">Le gardien essaiera de l'arr√™ter. Marquez 3 buts sur 5 tirs pour gagner! üèÜ</p>
    </header>
    <div class="stats-container">
     <div class="stat-box" id="goalsBox">
      ‚öΩ Buts: 0
     </div>
     <div class="stat-box" id="attemptsBox">
      üéØ Tirs: 0/5
     </div>
    </div>
    <div class="field-container" id="fieldContainer">
     <div class="goal-area">
      <div class="goal-background" id="goalBackground">
       <div class="goal-post-left"></div>
       <div class="goal-post-right"></div>
       <div class="goal-post-top"></div>
       <div class="goal-net" id="goalNet">
        <div class="goal-section" data-position="0"></div>
        <div class="goal-section" data-position="1"></div>
        <div class="goal-section" data-position="2"></div>
        <div class="goal-section" data-position="3"></div>
       </div>
       <div class="goalkeeper" id="goalkeeper">
        üß§
       </div>
       <div class="ball" id="ball">
        ‚öΩ
       </div>
      </div>
      <div class="result-message" id="resultMessage"></div>
     </div>
    </div>
    <div class="game-over-screen" id="gameOverScreen">
     <div class="game-over-title" id="gameOverTitle">
      üéâ
     </div>
     <p class="game-over-message" id="gameOverMessage">Vous avez gagn√©!</p>
     <div class="email-form-container" id="emailFormContainer" style="display: none;">
      <h2 class="form-title" id="formTitle">üéüÔ∏è Gagnez des billets pour le Paris FC!</h2>
      <p class="form-description" id="formDescription">Cliquez sur le bouton ci-dessous pour participer au tirage au sort</p><button class="submit-button" id="submitButton"> üé´ Participer au Tirage </button>
     </div>
    </div>
   </div><!-- End Game Content --> <!-- Already Played Screen -->
   <div class="already-played-screen" id="alreadyPlayedScreen">
    <div class="logos-container"><img src="https://i0.wp.com/d8.fr/wp-content/uploads/2025/10/cropped-Logo-CV.png?w=500&amp;ssl=1" alt="Logo D8" class="logo-img" onerror="this.style.display='none';"> <img src="https://boutique.parisfc.fr/cdn/shop/files/logo-pfc-white-110_1920x1920.png?v=1753194124" alt="Logo Paris FC" class="logo-img paris-fc" onerror="this.style.display='none';">
    </div>
    <div class="already-played-container" id="alreadyPlayedContainer">
     <h1 class="already-played-title" id="alreadyPlayedTitle">‚è±Ô∏è D√©j√† Jou√© Aujourd'hui! ‚è±Ô∏è</h1>
     <p class="already-played-message" id="alreadyPlayedMessage">Vous avez d√©j√† particip√© aujourd'hui.<br>
       Revenez demain pour une nouvelle chance de gagner!</p>
     <div class="countdown-text" id="countdownText">
      ‚è≥ Prochaine participation dans: <span id="countdown">--:--:--</span>
     </div>
    </div>
   </div>
  </div>
  <script>
    const defaultConfig = {
      background_color: "#112031",
      goal_color: "#1B4332",
      text_color: "#FFFFFF",
      button_color: "#0397cc",
      stat_box_color: "#0397cc",
      goalkeeper_color: "#FFD700",
      form_background_color: "#1A2F4A",
      input_border_color: "#0397cc",
      font_family: "Poppins",
      font_size: 16,
      game_title: "‚öΩ D√©fi Penalty Paris FC ‚öΩ",
      instruction_text: "Cliquez sur l'un des 4 coins pour tirer le penalty!",
      goal_target_label: "Le gardien essaiera de l'arr√™ter. Marquez 3 buts sur 5 tirs pour gagner! üèÜ",
      win_message: "F√©licitations! Vous avez gagn√©! üéâ",
      lose_message: "Pas de chance cette fois! Revenez demain pour une nouvelle tentative!",
      form_title: "üéüÔ∏è Gagnez des billets pour le Paris FC!",
      form_description: "Cliquez sur le bouton ci-dessous pour participer au tirage au sort",
      submit_button_text: "üé´ Participer au Tirage"
    };

    let goals = 0;
    let attempts = 0;
    const maxAttempts = 5;
    const targetGoals = 3;
    let isAnimating = false;
    let gameEnded = false;
    let submissionUrl = "";

    const rulesScreen = document.getElementById('rulesScreen');
    const gameContent = document.getElementById('gameContent');
    const acceptButton = document.getElementById('acceptButton');
    const alreadyPlayedScreen = document.getElementById('alreadyPlayedScreen');
    const sections = document.querySelectorAll('.goal-section');
    const goalkeeper = document.getElementById('goalkeeper');
    const ball = document.getElementById('ball');
    const resultMessage = document.getElementById('resultMessage');
    const goalsBox = document.getElementById('goalsBox');
    const attemptsBox = document.getElementById('attemptsBox');
    const fieldContainer = document.getElementById('fieldContainer');
    const gameOverScreen = document.getElementById('gameOverScreen');
    const emailFormContainer = document.getElementById('emailFormContainer');
    const countdownElement = document.getElementById('countdown');
    const submitButton = document.getElementById('submitButton');

    function hasPlayedToday() {
      const lastPlayedDate = localStorage.getItem('parisfc_last_played');
      if (!lastPlayedDate) return false;
      
      const today = new Date().toDateString();
      return lastPlayedDate === today;
    }

    function markAsPlayed() {
      const today = new Date().toDateString();
      localStorage.setItem('parisfc_last_played', today);
    }

    function getTimeUntilMidnight() {
      const now = new Date();
      const midnight = new Date();
      midnight.setHours(24, 0, 0, 0);
      return midnight - now;
    }

    function updateCountdown() {
      const timeLeft = getTimeUntilMidnight();
      const hours = Math.floor(timeLeft / (1000 * 60 * 60));
      const minutes = Math.floor((timeLeft % (1000 * 60 * 60)) / (1000 * 60));
      const seconds = Math.floor((timeLeft % (1000 * 60)) / 1000);
      
      countdownElement.textContent = `${String(hours).padStart(2, '0')}:${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`;
    }

    if (hasPlayedToday()) {
      rulesScreen.classList.add('hidden');
      alreadyPlayedScreen.classList.add('show');
      updateCountdown();
      setInterval(updateCountdown, 1000);
    }

    acceptButton.addEventListener('click', () => {
      if (hasPlayedToday()) {
        rulesScreen.classList.add('hidden');
        alreadyPlayedScreen.classList.add('show');
        updateCountdown();
        setInterval(updateCountdown, 1000);
      } else {
        rulesScreen.classList.add('hidden');
        gameContent.classList.add('visible');
        markAsPlayed();
      }
    });

    async function onConfigChange(config) {
      const gameWrapper = document.querySelector('.game-wrapper');
      const goalBackground = document.getElementById('goalBackground');
      const gameTitle = document.getElementById('gameTitle');
      const instructionText = document.getElementById('instructionText');
      const goalTarget = document.getElementById('goalTarget');
      const formTitle = document.getElementById('formTitle');
      const formDescription = document.getElementById('formDescription');
      const submitButton = document.getElementById('submitButton');
      const gameOverMessage = document.getElementById('gameOverMessage');
      const rulesContainer = document.getElementById('rulesContainer');
      const rulesTitle = document.getElementById('rulesTitle');
      const rulesContent = document.getElementById('rulesContent');
      const rulesHighlight = document.getElementById('rulesHighlight');
      const acceptButtonElement = document.getElementById('acceptButton');
      const alreadyPlayedContainer = document.getElementById('alreadyPlayedContainer');
      const alreadyPlayedTitle = document.getElementById('alreadyPlayedTitle');
      const alreadyPlayedMessage = document.getElementById('alreadyPlayedMessage');
      const countdownText = document.getElementById('countdownText');
      
      const customFont = config.font_family || defaultConfig.font_family;
      const baseSize = config.font_size || defaultConfig.font_size;
      const baseFontStack = 'Arial, sans-serif';

      gameWrapper.style.backgroundColor = config.background_color || defaultConfig.background_color;
      
      gameTitle.style.color = config.text_color || defaultConfig.text_color;
      instructionText.style.color = config.text_color || defaultConfig.text_color;
      goalTarget.style.color = config.text_color || defaultConfig.text_color;
      
      goalsBox.style.backgroundColor = config.stat_box_color || defaultConfig.stat_box_color;
      goalsBox.style.color = config.text_color || defaultConfig.text_color;
      attemptsBox.style.backgroundColor = config.stat_box_color || defaultConfig.stat_box_color;
      attemptsBox.style.color = config.text_color || defaultConfig.text_color;
      
      goalkeeper.style.backgroundColor = config.goalkeeper_color || defaultConfig.goalkeeper_color;
      
      emailFormContainer.style.backgroundColor = config.form_background_color || defaultConfig.form_background_color;
      formTitle.style.color = config.text_color || defaultConfig.text_color;
      formDescription.style.color = config.text_color || defaultConfig.text_color;
      
      submitButton.style.backgroundColor = config.button_color || defaultConfig.button_color;
      submitButton.style.color = config.text_color || defaultConfig.text_color;
      
      gameOverScreen.style.backgroundColor = config.form_background_color || defaultConfig.form_background_color;
      gameOverMessage.style.color = config.text_color || defaultConfig.text_color;

      rulesContainer.style.backgroundColor = config.form_background_color || defaultConfig.form_background_color;
      rulesTitle.style.color = config.text_color || defaultConfig.text_color;
      rulesContent.style.color = config.text_color || defaultConfig.text_color;
      rulesHighlight.style.backgroundColor = config.stat_box_color || defaultConfig.stat_box_color;
      rulesHighlight.style.borderLeftColor = config.button_color || defaultConfig.button_color;
      rulesHighlight.style.color = config.text_color || defaultConfig.text_color;
      acceptButtonElement.style.backgroundColor = config.button_color || defaultConfig.button_color;
      acceptButtonElement.style.color = config.text_color || defaultConfig.text_color;

      alreadyPlayedContainer.style.backgroundColor = config.form_background_color || defaultConfig.form_background_color;
      alreadyPlayedTitle.style.color = config.text_color || defaultConfig.text_color;
      alreadyPlayedMessage.style.color = config.text_color || defaultConfig.text_color;
      countdownText.style.backgroundColor = config.stat_box_color || defaultConfig.stat_box_color;
      countdownText.style.color = config.text_color || defaultConfig.text_color;

      gameTitle.style.fontFamily = `${customFont}, ${baseFontStack}`;
      instructionText.style.fontFamily = `${customFont}, ${baseFontStack}`;
      goalTarget.style.fontFamily = `${customFont}, ${baseFontStack}`;
      goalsBox.style.fontFamily = `${customFont}, ${baseFontStack}`;
      attemptsBox.style.fontFamily = `${customFont}, ${baseFontStack}`;
      formTitle.style.fontFamily = `${customFont}, ${baseFontStack}`;
      formDescription.style.fontFamily = `${customFont}, ${baseFontStack}`;
      submitButton.style.fontFamily = `${customFont}, ${baseFontStack}`;
      rulesTitle.style.fontFamily = `${customFont}, ${baseFontStack}`;
      rulesContent.style.fontFamily = `${customFont}, ${baseFontStack}`;
      acceptButtonElement.style.fontFamily = `${customFont}, ${baseFontStack}`;
      alreadyPlayedTitle.style.fontFamily = `${customFont}, ${baseFontStack}`;
      alreadyPlayedMessage.style.fontFamily = `${customFont}, ${baseFontStack}`;
      countdownText.style.fontFamily = `${customFont}, ${baseFontStack}`;

      gameTitle.style.fontSize = `${baseSize * 3}px`;
      instructionText.style.fontSize = `${baseSize * 1.125}px`;
      goalTarget.style.fontSize = `${baseSize * 1.125}px`;
      goalsBox.style.fontSize = `${baseSize * 1.5}px`;
      attemptsBox.style.fontSize = `${baseSize * 1.5}px`;
      formTitle.style.fontSize = `${baseSize * 1.75}px`;
      formDescription.style.fontSize = `${baseSize}px`;
      submitButton.style.fontSize = `${baseSize * 1.125}px`;
      rulesTitle.style.fontSize = `${baseSize * 2.25}px`;
      acceptButtonElement.style.fontSize = `${baseSize * 1.25}px`;
      alreadyPlayedTitle.style.fontSize = `${baseSize * 2.625}px`;
      alreadyPlayedMessage.style.fontSize = `${baseSize * 1.25}px`;
      countdownText.style.fontSize = `${baseSize * 1.5}px`;

      gameTitle.textContent = config.game_title || defaultConfig.game_title;
      instructionText.textContent = config.instruction_text || defaultConfig.instruction_text;
      goalTarget.textContent = config.goal_target_label || defaultConfig.goal_target_label;
      formTitle.textContent = config.form_title || defaultConfig.form_title;
      formDescription.textContent = config.form_description || defaultConfig.form_description;
      submitButton.textContent = config.submit_button_text || defaultConfig.submit_button_text;
    }

    function updateStats() {
      goalsBox.textContent = `‚öΩ Buts: ${goals}`;
      attemptsBox.textContent = `üéØ Tirs: ${attempts}/${maxAttempts}`;
    }

    function getGridPosition(index) {
      const row = Math.floor(index / 2);
      const col = index % 2;
      const centerX = 50;
      const centerY = 50;
      const horizontalSpacing = 35;
      const verticalSpacing = 35;
      
      return {
        x: centerX + (col - 0.5) * horizontalSpacing,
        y: centerY + (row - 0.5) * verticalSpacing
      };
    }

    function createConfetti() {
      const colors = ['#FFD700', '#FF6B6B', '#4ECDC4', '#45B7D1', '#FFA07A', '#98D8C8', '#F7DC6F', '#BB8FCE'];
      const confettiCount = 40;
      
      for (let i = 0; i < confettiCount; i++) {
        const confetti = document.createElement('div');
        confetti.className = 'confetti';
        confetti.style.left = `${Math.random() * 100}%`;
        confetti.style.top = '0%';
        confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
        confetti.style.width = `${Math.random() * 10 + 5}px`;
        confetti.style.height = `${Math.random() * 10 + 5}px`;
        confetti.style.animationDelay = `${Math.random() * 0.3}s`;
        
        fieldContainer.appendChild(confetti);
        
        setTimeout(() => confetti.classList.add('active'), 10);
        
        setTimeout(() => confetti.remove(), 2500);
      }
    }

    function shootBall(targetPosition) {
      if (isAnimating || gameEnded) return;
      isAnimating = true;
      attempts++;

      sections.forEach(s => s.classList.add('disabled'));

      let goalkeeperPosition;
      
      if (Math.random() < 0.35) {
        goalkeeperPosition = targetPosition;
      } else {
        const otherPositions = [0, 1, 2, 3].filter(p => p !== targetPosition);
        goalkeeperPosition = otherPositions[Math.floor(Math.random() * otherPositions.length)];
      }

      const targetPos = getGridPosition(targetPosition);
      const goalkeeperPos = getGridPosition(goalkeeperPosition);

      goalkeeper.style.transition = `all 0.35s ease`;
      goalkeeper.style.left = `${goalkeeperPos.x}%`;
      goalkeeper.style.top = `${goalkeeperPos.y}%`;

      ball.classList.add('shooting');
      ball.style.left = `${targetPos.x}%`;
      ball.style.bottom = `${100 - targetPos.y}%`;
      ball.style.transform = 'translate(-50%, 50%) scale(0.6)';

      setTimeout(() => {
        const isGoal = targetPosition !== goalkeeperPosition;
        
        if (isGoal) {
          goals++;
          resultMessage.textContent = '‚öΩ BUT! üéâ';
          resultMessage.style.color = '#2ECC71';
          createConfetti();
        } else {
          resultMessage.textContent = 'üß§ ARR√äT√â! üß§';
          resultMessage.style.color = '#E74C3C';
        }

        updateStats();
        resultMessage.classList.add('show');

        setTimeout(() => {
          resultMessage.classList.remove('show');
          
          if (attempts >= maxAttempts) {
            endGame();
          } else {
            resetBallAndGoalkeeper();
            sections.forEach(s => s.classList.remove('disabled'));
          }
        }, 1500);
      }, 700);
    }

    function resetBallAndGoalkeeper() {
      ball.classList.remove('shooting');
      ball.style.left = '50%';
      ball.style.bottom = '5%';
      ball.style.transform = 'translateX(-50%)';
      
      goalkeeper.style.left = '50%';
      goalkeeper.style.top = '50%';
      goalkeeper.style.transform = 'translate(-50%, -50%)';
      
      isAnimating = false;
    }

    function endGame() {
      gameEnded = true;
      fieldContainer.style.display = 'none';
      gameOverScreen.classList.add('show');
      
      const config = window.elementSdk?.config || defaultConfig;
      const gameOverTitle = document.getElementById('gameOverTitle');
      const gameOverMessage = document.getElementById('gameOverMessage');
      
      if (goals >= targetGoals) {
        gameOverTitle.textContent = 'üéâ VICTOIRE! üéâ';
        gameOverTitle.classList.add('victory');
        gameOverMessage.textContent = config.win_message || defaultConfig.win_message;
        emailFormContainer.style.display = 'block';
      } else {
        gameOverTitle.textContent = '‚öΩ D√âFAITE ‚öΩ';
        gameOverTitle.classList.remove('victory');
        gameOverMessage.textContent = config.lose_message || defaultConfig.lose_message;
        emailFormContainer.style.display = 'none';
      }
    }

    sections.forEach((section) => {
      section.addEventListener('click', () => {
        const position = parseInt(section.dataset.position);
        shootBall(position);
      });
    });

    submitButton.addEventListener('click', (e) => {
      e.preventDefault();
      window.open('https://app.evalandgo.com/f/374014/4qP9VfdZeMHafNCZMUiGX3', '_blank', 'noopener,noreferrer');
    });

    if (window.elementSdk) {
      window.elementSdk.init({
        defaultConfig,
        onConfigChange,
        mapToCapabilities: (config) => ({
          recolorables: [
            {
              get: () => config.background_color || defaultConfig.background_color,
              set: (value) => {
                config.background_color = value;
                window.elementSdk.setConfig({ background_color: value });
              }
            },
            {
              get: () => config.goal_color || defaultConfig.goal_color,
              set: (value) => {
                config.goal_color = value;
                window.elementSdk.setConfig({ goal_color: value });
              }
            },
            {
              get: () => config.text_color || defaultConfig.text_color,
              set: (value) => {
                config.text_color = value;
                window.elementSdk.setConfig({ text_color: value });
              }
            },
            {
              get: () => config.button_color || defaultConfig.button_color,
              set: (value) => {
                config.button_color = value;
                window.elementSdk.setConfig({ button_color: value });
              }
            },
            {
              get: () => config.goalkeeper_color || defaultConfig.goalkeeper_color,
              set: (value) => {
                config.goalkeeper_color = value;
                window.elementSdk.setConfig({ goalkeeper_color: value });
              }
            }
          ],
          borderables: [],
          fontEditable: {
            get: () => config.font_family || defaultConfig.font_family,
            set: (value) => {
              config.font_family = value;
              window.elementSdk.setConfig({ font_family: value });
            }
          },
          fontSizeable: {
            get: () => config.font_size || defaultConfig.font_size,
            set: (value) => {
              config.font_size = value;
              window.elementSdk.setConfig({ font_size: value });
            }
          }
        }),
        mapToEditPanelValues: (config) => new Map([
          ["game_title", config.game_title || defaultConfig.game_title],
          ["instruction_text", config.instruction_text || defaultConfig.instruction_text],
          ["goal_target_label", config.goal_target_label || defaultConfig.goal_target_label],
          ["win_message", config.win_message || defaultConfig.win_message],
          ["lose_message", config.lose_message || defaultConfig.lose_message],
          ["form_title", config.form_title || defaultConfig.form_title],
          ["form_description", config.form_description || defaultConfig.form_description],
          ["submit_button_text", config.submit_button_text || defaultConfig.submit_button_text]
        ])
      });
    }

    onConfigChange(defaultConfig);
  </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9baa7971d5ec99a5',t:'MTc2Nzg2MjUxMC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
